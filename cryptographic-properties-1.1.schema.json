{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/IBM/CBOM/main/cryptographic-properties-1.1.schema.json",
    "type": "object",
    "title": "Crypto Properties",
    "$comment": "Properties for Crypto Assets",
    "cryptoProperties": {
        "type": "object",
        "title": "Crypto Properties",
        "description": "Properties for Crypto Assets",
        "additionalProperties": false,
        "properties": {
            "assetType": {
                "type": "string",
                "title": "assetType",
                "description": "The specific asset type for the crypto asset",
                "enum": [
                    "algorithm",
                    "certificate",
                    "relatedCryptoMaterial",
                    "protocol"
                ]
            },
            "algorithmProperties": {
                "type": "object",
                "title": "algorithm properties",
                "description": "Properties for crypto assets of asset type 'algorithm'",
                "additionalProperties": false,
                "properties": {
                    "primitive": {
                        "type": "string",
                        "title": "primitive",
                        "description": "The primitive for the crypto algorithm",
                        "enum": [
                            "drbg",
                            "mac",
                            "blockcipher",
                            "streamcipher",
                            "signature",
                            "hash",
                            "pke",
                            "xof",
                            "kdf",
                            "keyagree",
                            "kem",
                            "ae",
                            "other",
                            "unknown"
                        ]
                    },
                    "variant": {
                        "type": "string",
                        "title": "variant",
                        "description": "The variant for the crypto algorithm"
                    },
                    "implementationLevel": {
                        "type": "string",
                        "title": "implementation level",
                        "description": "The implementation level for the crypto algorithm",
                        "enum": [
                            "softwarePlainRam",
                            "softwareEncryptedRam",
                            "softwareTee",
                            "hardware",
                            "other",
                            "unknown"
                        ]
                    },
                    "implementationPlatform": {
                        "type": "string",
                        "title": "implementation platform",
                        "description": "The implementation platform for the crypto algorithm",
                        "enum": [
                            "generic",
                            "x86_32",
                            "x86_64",
                            "armv7-a",
                            "armv7-m",
                            "armv8-a",
                            "armv8-m",
                            "s390x",
                            "ppc64",
                            "ppc64le",
                            "other",
                            "unknown"
                        ]
                    },
                    "certificationLevel": {
                        "type": "string",
                        "title": "certification level",
                        "description": "The certification level for the crypto algorithm",
                        "enum": [
                            "none",
                            "fips140-2-l1",
                            "fips140-2-l2",
                            "fips140-2-l3",
                            "fips140-2-l4",
                            "fips140-2-l5",
                            "fips140-3-l1",
                            "fips140-3-l2",
                            "fips140-3-l3",
                            "fips140-3-l4",
                            "fips140-3-l5",
                            "eal1",
                            "eal2",
                            "eal3",
                            "eal4",
                            "eal5",
                            "eal6",
                            "eal7",
                            "other",
                            "unknown"
                        ]
                    },
                    "mode": {
                        "type": "string",
                        "title": "mode",
                        "description": "The cipher mode of operation for the crypto algorithm",
                        "enum": [
                            "cbc",
                            "ecb",
                            "ccm",
                            "gcm",
                            "cfb",
                            "ofb",
                            "ctr",
                            "other",
                            "unknown"
                        ]
                    },
                    "padding": {
                        "type": "string",
                        "title": "padding",
                        "description": "The padding for the crypto algorithm ",
                        "enum": [
                            "pkcs5",
                            "pkcs7",
                            "pkcs1v15",
                            "oaep",
                            "raw",
                            "other",
                            "unknown"
                        ]
                    },
                    "cryptoFunctions": {
                        "type": "array",
                        "title": "crypto function",
                        "description": "The crypto functions implemented by the crypto algorithm",
                        "items": {
                            "type": "string",
                            "enum": [
                                "generate",
                                "keygen",
                                "encrypt",
                                "decrypt",
                                "digest",
                                "tag",
                                "keyderive",
                                "sign",
                                "verify",
                                "encapsulate",
                                "decapsulate",
                                "other",
                                "unknown"
                            ]
                        }
                    },
                    "classicalSecurityLevel": {
                        "type": "integer",
                        "title": "classical security level",
                        "description": "classical security level",
                        "minimum": 0
                    },
                    "nistQuantumSecurityLevel": {
                        "type": "integer",
                        "title": "NIST security strength category",
                        "description": "NIST security strength category as defined in https://csrc.nist.gov/projects/post-quantum-cryptography/post-quantum-cryptography-standardization/evaluation-criteria/security-(evaluation-criteria), or 0 if none of the categories are met",
                        "minimum": 0,
                        "maximum": 6
                    }
                }
            },
            "certificateProperties": {
                "type": "object",
                "title": "certificate properties",
                "description": "Properties for crypto assets of asset type 'certificate'",
                "additionalProperties": false,
                "properties": {
                    "subjectName": {
                        "type": "string",
                        "title": "Subject Name",
                        "description": "The subject name for the crypto certificate"
                    },
                    "issuerName": {
                        "type": "string",
                        "title": "Issuer Name",
                        "description": "The issuer name for the crypto certificate"
                    },
                    "notValidBefore": {
                        "type": "string",
                        "title": "Not Valid Before",
                        "description": "The date and time according to ISO-8601 standard from which the certificate is valid"
                    },
                    "notValidAfter": {
                        "type": "string",
                        "title": "Not Valid After",
                        "description": "The date and time according to ISO-8601 standard from which the certificate is not valid anymore"
                    },
                    "signatureAlgorithm": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Algorithm reference",
                        "description": "Bom-ref to signature algorithm used by the certificate"
                    },
                    "subjectPublicKeyAlgorithm": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Algorithm reference",
                        "description": "Bom-ref to the algorithm used to generate the public key for the subject"
                    },
                    "subjectPublicKey": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Key reference",
                        "description": "Bom-ref to the public key of the subject"
                    },
                    "certificateFormat": {
                        "type": "string",
                        "title": "Certificate format",
                        "description": "The format of the certificate",
                        "examples": [
                            "X.509",
                            "PEM",
                            "DER",
                            "CVC"
                        ]
                    },
                    "certificateExtension": {
                        "type": "string",
                        "title": "Certificate extensions",
                        "description": "The certificate extensions of the crypto certificate",
                        "examples": [
                            "crt",
                            "pem",
                            "cer",
                            "der",
                            "p12"
                        ]
                    }
                }
            },
            "relatedCryptoMaterialProperties": {
                "type": "object",
                "title": "related crypto material properties",
                "description": "Properties for crypto assets of asset type 'relatedCryptoMaterial'",
                "additionalProperties": false,
                "properties": {
                    "relatedCryptoMaterialType": {
                        "type": "string",
                        "title": "relatedCryptoMaterialType",
                        "description": "The type for the related crypto material",
                        "enum": [
                            "privateKey",
                            "publicKey",
                            "secretKey",
                            "ciphertext",
                            "signature",
                            "digest",
                            "initializationVector",
                            "nonce",
                            "seed",
                            "salt",
                            "sharedSecret",
                            "tag",
                            "additionalData",
                            "password",
                            "credential",
                            "token",
                            "other",
                            "unknown"
                        ]
                    },
                    "size": {
                        "type": "integer",
                        "title": "size (in bits)",
                        "description": "size of the related crypto material (in bits)"
                    },
                    "format": {
                        "type": "string",
                        "title": "format",
                        "description": "format of the related crypto material (e.g. P8, PEM, DER)"
                    },
                    "secured": {
                        "type": "boolean",
                        "title": "relatedCryptoMaterial is secured",
                        "description": "indicates if the related crypto material is secured or not"
                    }
                }
            },
            "protocolProperties": {
                "type": "object",
                "title": "protocol properties",
                "description": "Properties for crypto assets of asset type 'protocol'",
                "additionalProperties": false,
                "properties": {
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "The concrete protocol type",
                        "enum": [
                            "tls",
                            "ssh",
                            "ipsec",
                            "ike",
                            "sstp",
                            "wpa",
                            "other",
                            "unknown"
                        ]
                    },
                    "name": {
                        "type": "string",
                        "title": "protocol name",
                        "description": "The common name of the protocol",
                        "examples": [
                            "TLSv1.3", "SSH-1.99"
                        ]
                    },
                    "version": {
                        "type": "string",
                        "title": "protocol version",
                        "description": "The version of the protocol",
                        "examples": [
                            "1.0",
                            "1.2",
                            "1.99"
                        ]
                    },
                    "tlsCipherSuites": {
                        "type": "array",
                        "title": "TLS cipher suites supported",
                        "description": "the TLS cipher suites supported, with naming convention according to IANA https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4"
                    },
                    "ikev2TransformTypes": {
                        "type": "object",
                        "title": "IKEv2 transform types supported",
                        "description": "the IKEv2 transform types supported (types 1-4), according to RFC5996, section 3.3.2",
                        "properties": {
                            "transformType1": {
                                "type": "array",
                                "title": "Transform Type 1: encryption algorithms"
                            },
                            "transformType2": {
                                "type": "array",
                                "title": "Transform Type 2: pseudorandom functions"
                            },
                            "transformType3": {
                                "type": "array",
                                "title": "Transform Type 3: integrity algorithms"
                            },
                            "transformType4": {
                                "type": "array",
                                "title": "Transform Type 4: DH groups"
                            }
                        }
                    }
                }
            },
            "oid": {
                "type": "string",
                "title": "OID",
                "description": "OID of crypto asset"
            },
            "confidenceLevels": {
                "type": "object",
                "additionalItems": false,
                "title": "confidence levels",
                "description": "confidence levels of the reported crypto properties",
                "properties": {
                    "assetType": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "assetType confidence level"
                    },
                    "primitive": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "primitive confidence level"
                    },
                    "relatedCryptoMaterialType": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "related crypto material confidence level"
                    },
                    "variant": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "variant confidence level"
                    },
                    "mode": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "mode of opreation confidence level"
                    },
                    "padding": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "padding confidence level"
                    },
                    "cryptoFunctions": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "related crypto material confidence level"
                    },
                    "subjectName": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "subjectName confidence level"
                    },
                    "issuerName": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "issuerName confidence level"
                    },
                    "notValidBefore": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "notValidBefore confidence level"
                    },
                    "notValidAfter": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "notValidAfter confidence level"
                    },
                    "certificateAlgorithm": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateAlgorithm confidence level"
                    },
                    "certificateSignatureAlgorithm": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateSignatureAlgorithm confidence level"
                    },
                    "certificateFormat": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateFormat confidence level"
                    },
                    "certificateExtension": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateExtension confidence level"
                    },
                    "tlsCipherSuites": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "tlsCipherSuites confidence level"
                    },
                    "ikev2TransformTypes": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "ikev2TransformTypes confidence level"
                    }
                }
            },
            "detectionContext": {
                "type": "array",
                "additionalItems": false,
                "title": "detection context",
                "description": "Defines additional context metadata related to the detected crypto asset",
                "items": {
                    "type": "object",
                    "title": "detection context",
                    "additionalProperties": false,
                    "properties": {
                        "filePath": {
                            "type": "string",
                            "title": "filePath",
                            "description": "File path of the detected crypto asset"
                        },
                        "lineNumbers": {
                            "type": "array",
                            "title": "lineNumbers",
                            "description": "Line numbers of the detected crypto asset"
                        },
                        "offsets": {
                            "type": "array",
                            "title": "offsets",
                            "description": "Offsets of the detected crypto asset"
                        },
                        "symbols": {
                            "type": "array",
                            "title": "symbols",
                            "description": "symbol names detected for the crypto asset"
                        },
                        "keywords": {
                            "type": "array",
                            "title": "keywords",
                            "description": "keywords detected for the crypto asset"
                        },
                        "additionalContext": {
                            "type": "string",
                            "title": "additionalContext",
                            "description": "additional context of the detected crypto asset (e.g. code snippet)"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "cryptoRef": {
            "type": "string",
            "title": "Reference to a crypto asset",
            "description": "Reference (bom-ref) to the crypto asset used in this context"
        },
        "confidenceLevel": {
            "title": "ConfidenceLevel",
            "description": "The ConfidenceLevel related to a property",
            "type": "number"
        }
    }
}