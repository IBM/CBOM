{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/IBM/CBOM/main/cryptographic-properties-1.1.schema.json",
    "type": "object",
    "title": "Crypto Properties",
    "$comment": "Properties for Crypto Assets",
    "cryptoProperties": {
        "type": "object",
        "title": "Crypto Properties",
        "description": "Properties for Crypto Assets",
        "additionalProperties": false,
        "properties": {
            "assetType": {
                "type": "string",
                "title": "assetType",
                "description": "The specific asset type for the crypto asset",
                "enum": [
                    "algorithm",
                    "certificate",
                    "protocol",
                    "relatedCryptoMaterial"
                ]
            },
            "algorithmProperties": {
                "type": "object",
                "title": "algorithm properties",
                "description": "Properties for crypto assets of asset type 'algorithm'",
                "additionalProperties": false,
                "properties": {
                    "primitive": {
                        "type": "string",
                        "title": "primitive",
                        "description": "The primitive for the crypto algorithm",
                        "enum": [
                            "drbg",
                            "mac",
                            "blockcipher",
                            "streamcipher",
                            "signature",
                            "hash",
                            "pke",
                            "xof",
                            "kdf",
                            "keyagree",
                            "kem",
                            "ae",
                            "other",
                            "unknown"
                        ]
                    },
                    "variant": {
                        "type": "string",
                        "title": "variant",
                        "description": "The variant for the crypto algorithm"
                    },
                    "curve": {
                        "type": "string",
                        "title": "elliptic curve",
                        "description": "If applicable, the curve of the crypto algorithm",
                        "enum": [
                            "brainpoolP160r1",
                            "brainpoolP160t1",
                            "brainpoolP192r1",
                            "brainpoolP192t1",
                            "brainpoolP224r1",
                            "brainpoolP224t1",
                            "brainpoolP256r1",
                            "brainpoolP256t1",
                            "brainpoolP320r1",
                            "brainpoolP320t1",
                            "brainpoolP384r1",
                            "brainpoolP384t1",
                            "brainpoolP512r1",
                            "brainpoolP512t1",
                            "secp160k1",
                            "secp192k1",
                            "secp224k1",
                            "secp256k1",
                            "secp112r1",
                            "secp128r1",
                            "secp160r1",
                            "secp192r1",
                            "secp224r1",
                            "secp256r1",
                            "secp384r1",
                            "secp521r1",
                            "secp112r2",
                            "secp128r2",
                            "secp160r2",
                            "sect163k1",
                            "sect233k1",
                            "sect239k1",
                            "sect283k1",
                            "sect409k1",
                            "sect571k1",
                            "sect113r1",
                            "sect131r1",
                            "sect163r1",
                            "sect193r1",
                            "sect233r1",
                            "sect283r1",
                            "sect409r1",
                            "sect571r1",
                            "sect113r2",
                            "sect131r2",
                            "sect163r2",
                            "sect193r2",
                            "BLS12-377",
                            "BLS12-381",
                            "BLS12-446",
                            "BLS12-455",
                            "BLS12-638",
                            "BLS24-477",
                            "gost256",
                            "gost512",
                            "curve25519",
                            "curve448",
                            "sm2",
                            "Fp256BN",
                            "Fp384BN",
                            "Fp512BN",
                            "prime192v1",
                            "prime192v2",
                            "prime192v3",
                            "prime239v1",
                            "prime239v2",
                            "prime239v3",
                            "prime256v1",
                            "c2pnb176w1",
                            "c2pnb163v1",
                            "c2pnb163v2",
                            "c2pnb163v3",
                            "c2pnb208w1",
                            "c2tnb191v3",
                            "c2tnb191v2",
                            "c2tnb191v1",
                            "c2tnb239v3",
                            "c2tnb239v2",
                            "c2tnb239v1",
                            "c2pnb272w1",
                            "c2pnb304w1",
                            "c2pnb368w1",
                            "c2tnb359v1",
                            "c2tnb431r1",
                            "c2onb191v4",
                            "c2onb191v5",
                            "c2onb239v4",
                            "c2onb239v5",
                            "ansit163k1",
                            "ansit163r1",
                            "ansit163r2",
                            "ansit193r1",
                            "ansit193r2",
                            "ansit233k1",
                            "ansit233r1",
                            "ansit239k1",
                            "ansit283k1",
                            "ansit283r1",
                            "ansit409k1",
                            "ansit409r1",
                            "ansit571k1",
                            "ansit571r1",
                            "ansip160k1",
                            "ansip160r1",
                            "ansip160r2",
                            "ansip192k1",
                            "ansip224k1",
                            "ansip224r1",
                            "ansip256k1",
                            "ansip384r1",
                            "ansip521r1",
                            "FRP256v1",
                            "bn158",
                            "bn190",
                            "bn222",
                            "bn254",
                            "bn286",
                            "bn318",
                            "bn350",
                            "bn382",
                            "bn414",
                            "bn446",
                            "bn478",
                            "bn510",
                            "bn542",
                            "bn574",
                            "bn606",
                            "bn638",
                            "P-192",
                            "P-224",
                            "P-256",
                            "P-384",
                            "P-521",
                            "K-163",
                            "B-163",
                            "K-233",
                            "B-233",
                            "K-283",
                            "B-283",
                            "K-409",
                            "B-409",
                            "K-571",
                            "B-571",
                            "FourQ",
                            "wap-wsg-idm-ecid-wtls1",
                            "wap-wsg-idm-ecid-wtls3",
                            "wap-wsg-idm-ecid-wtls4",
                            "wap-wsg-idm-ecid-wtls5",
                            "wap-wsg-idm-ecid-wtls6",
                            "wap-wsg-idm-ecid-wtls7",
                            "wap-wsg-idm-ecid-wtls8",
                            "wap-wsg-idm-ecid-wtls9",
                            "wap-wsg-idm-ecid-wtls1",
                            "wap-wsg-idm-ecid-wtls1",
                            "wap-wsg-idm-ecid-wtls1",
                            "Other"
                        ]
                    },
                    "implementationLevel": {
                        "type": "string",
                        "title": "implementation level",
                        "description": "The implementation level for the crypto algorithm",
                        "enum": [
                            "softwarePlainRam",
                            "softwareEncryptedRam",
                            "softwareTee",
                            "hardware",
                            "other",
                            "unknown"
                        ]
                    },
                    "implementationPlatform": {
                        "type": "string",
                        "title": "implementation platform",
                        "description": "The implementation platform for the crypto algorithm",
                        "enum": [
                            "generic",
                            "x86_32",
                            "x86_64",
                            "armv7-a",
                            "armv7-m",
                            "armv8-a",
                            "armv8-m",
                            "s390x",
                            "ppc64",
                            "ppc64le",
                            "other",
                            "unknown"
                        ]
                    },
                    "certificationLevel": {
                        "type": "string",
                        "title": "certification level",
                        "description": "The certification level for the crypto algorithm",
                        "enum": [
                            "none",
                            "fips140-2-l1",
                            "fips140-2-l2",
                            "fips140-2-l3",
                            "fips140-2-l4",
                            "fips140-2-l5",
                            "fips140-3-l1",
                            "fips140-3-l2",
                            "fips140-3-l3",
                            "fips140-3-l4",
                            "fips140-3-l5",
                            "eal1",
                            "eal2",
                            "eal3",
                            "eal4",
                            "eal5",
                            "eal6",
                            "eal7",
                            "other",
                            "unknown"
                        ]
                    },
                    "mode": {
                        "type": "string",
                        "title": "mode",
                        "description": "The cipher mode of operation for the crypto algorithm",
                        "enum": [
                            "cbc",
                            "ecb",
                            "ccm",
                            "gcm",
                            "cfb",
                            "ofb",
                            "ctr",
                            "other",
                            "unknown"
                        ]
                    },
                    "padding": {
                        "type": "string",
                        "title": "padding",
                        "description": "The padding for the crypto algorithm ",
                        "enum": [
                            "pkcs5",
                            "pkcs7",
                            "pkcs1v15",
                            "oaep",
                            "raw",
                            "other",
                            "unknown"
                        ]
                    },
                    "cryptoFunctions": {
                        "type": "array",
                        "title": "crypto function",
                        "description": "The crypto functions implemented by the crypto algorithm",
                        "items": {
                            "type": "string",
                            "enum": [
                                "generate",
                                "keygen",
                                "encrypt",
                                "decrypt",
                                "digest",
                                "tag",
                                "keyderive",
                                "sign",
                                "verify",
                                "encapsulate",
                                "decapsulate",
                                "other",
                                "unknown"
                            ]
                        }
                    },
                    "classicalSecurityLevel": {
                        "type": "integer",
                        "title": "classical security level",
                        "description": "classical security level",
                        "minimum": 0
                    },
                    "nistQuantumSecurityLevel": {
                        "type": "integer",
                        "title": "NIST security strength category",
                        "description": "NIST security strength category as defined in https://csrc.nist.gov/projects/post-quantum-cryptography/post-quantum-cryptography-standardization/evaluation-criteria/security-(evaluation-criteria), or 0 if none of the categories are met",
                        "minimum": 0,
                        "maximum": 6
                    }
                }
            },
            "certificateProperties": {
                "type": "object",
                "title": "certificate properties",
                "description": "Properties for crypto assets of asset type 'certificate'",
                "additionalProperties": false,
                "properties": {
                    "subjectName": {
                        "type": "string",
                        "title": "Subject Name",
                        "description": "The subject name for the crypto certificate"
                    },
                    "issuerName": {
                        "type": "string",
                        "title": "Issuer Name",
                        "description": "The issuer name for the crypto certificate"
                    },
                    "notValidBefore": {
                        "type": "string",
                        "title": "Not Valid Before",
                        "description": "The date and time according to ISO-8601 standard from which the certificate is valid"
                    },
                    "notValidAfter": {
                        "type": "string",
                        "title": "Not Valid After",
                        "description": "The date and time according to ISO-8601 standard from which the certificate is not valid anymore"
                    },
                    "signatureAlgorithm": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Algorithm reference",
                        "description": "Bom-ref to signature algorithm used by the certificate"
                    },
                    "subjectPublicKeyAlgorithm": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Algorithm reference",
                        "description": "Bom-ref to the algorithm used to generate the public key for the subject"
                    },
                    "subjectPublicKey": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Key reference",
                        "description": "Bom-ref to the public key of the subject"
                    },
                    "certificateFormat": {
                        "type": "string",
                        "title": "Certificate format",
                        "description": "The format of the certificate",
                        "examples": [
                            "X.509",
                            "PEM",
                            "DER",
                            "CVC"
                        ]
                    },
                    "certificateExtension": {
                        "type": "string",
                        "title": "Certificate extensions",
                        "description": "The certificate extensions of the crypto certificate",
                        "examples": [
                            "crt",
                            "pem",
                            "cer",
                            "der",
                            "p12"
                        ]
                    }
                }
            },
            "relatedCryptoMaterialProperties": {
                "type": "object",
                "title": "related crypto material properties",
                "description": "Properties for crypto assets of asset type 'relatedCryptoMaterial'",
                "additionalProperties": false,
                "properties": {
                    "type": {
                        "type": "string",
                        "title": "relatedCryptoMaterialType",
                        "description": "The type for the related crypto material",
                        "enum": [
                            "privateKey",
                            "publicKey",
                            "secretKey",
                            "ciphertext",
                            "signature",
                            "digest",
                            "initializationVector",
                            "nonce",
                            "seed",
                            "salt",
                            "sharedSecret",
                            "tag",
                            "additionalData",
                            "password",
                            "credential",
                            "token",
                            "other",
                            "unknown"
                        ]
                    },
                    "value": {
                        "type": "string",
                        "title": "Value assosiated to the crypto material",
                        "description": "The assosiated value of the crypto material"
                    },
                    "size": {
                        "type": "integer",
                        "title": "size (in bits)",
                        "description": "size of the related crypto material (in bits)"
                    },
                    "format": {
                        "type": "string",
                        "title": "format",
                        "description": "format of the related crypto material (e.g. P8, PEM, DER)"
                    },
                    "secured": {
                        "type": "boolean",
                        "title": "relatedCryptoMaterial is secured",
                        "description": "indicates if the related crypto material is secured or not"
                    }
                }
            },
            "protocolProperties": {
                "type": "object",
                "title": "protocol properties",
                "description": "Properties for crypto assets of asset type 'protocol'",
                "additionalProperties": false,
                "properties": {
                    "type": {
                        "type": "string",
                        "title": "type",
                        "description": "The concrete protocol type",
                        "enum": [
                            "tls",
                            "ssh",
                            "ipsec",
                            "ike",
                            "sstp",
                            "wpa",
                            "other",
                            "unknown"
                        ]
                    },
                    "name": {
                        "type": "string",
                        "title": "protocol name",
                        "description": "The common name of the protocol",
                        "examples": [
                            "TLSv1.3",
                            "SSH-1.99"
                        ]
                    },
                    "version": {
                        "type": "string",
                        "title": "protocol version",
                        "description": "The version of the protocol",
                        "examples": [
                            "1.0",
                            "1.2",
                            "1.99"
                        ]
                    },
                    "cipherSuites": {
                        "type": "array",
                        "title": "Cipher suites related to the protocol",
                        "description": "A list of cipher suites related to the protocol",
                        "additionalItems": false,
                        "items": {
                            "$ref": "#/definitions/cipherSuite",
                            "title": "Cipher suite"
                        }
                    },
                    "ikev2TransformTypes": {
                        "type": "object",
                        "title": "IKEv2 transform types supported",
                        "description": "the IKEv2 transform types supported (types 1-4), according to RFC5996, section 3.3.2",
                        "properties": {
                            "encr": {
                                "$ref": "#/definitions/cryptoRefArray",
                                "title": "Transform Type 1: encryption algorithms"
                            },
                            "prf": {
                                "$ref": "#/definitions/cryptoRefArray",
                                "title": "Transform Type 2: pseudorandom functions"
                            },
                            "integ": {
                                "$ref": "#/definitions/cryptoRefArray",
                                "title": "Transform Type 3: integrity algorithms"
                            },
                            "dh": {
                                "$ref": "#/definitions/cryptoRefArray",
                                "title": "Transform Type 4: DH groups"
                            },
                            "esn": {
                                "type": "boolean",
                                "title": "Extended Sequence Number is used"
                            }
                        }
                    }
                }
            },
            "oid": {
                "type": "string",
                "title": "OID",
                "description": "OID of crypto asset"
            },
            "confidenceLevels": {
                "type": "object",
                "additionalItems": false,
                "title": "confidence levels",
                "description": "confidence levels of the reported crypto properties",
                "properties": {
                    "assetType": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "assetType confidence level"
                    },
                    "primitive": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "primitive confidence level"
                    },
                    "relatedCryptoMaterialType": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "related crypto material confidence level"
                    },
                    "variant": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "variant confidence level"
                    },
                    "mode": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "mode of opreation confidence level"
                    },
                    "padding": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "padding confidence level"
                    },
                    "cryptoFunctions": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "related crypto material confidence level"
                    },
                    "subjectName": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "subjectName confidence level"
                    },
                    "issuerName": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "issuerName confidence level"
                    },
                    "notValidBefore": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "notValidBefore confidence level"
                    },
                    "notValidAfter": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "notValidAfter confidence level"
                    },
                    "certificateAlgorithm": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateAlgorithm confidence level"
                    },
                    "certificateSignatureAlgorithm": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateSignatureAlgorithm confidence level"
                    },
                    "certificateFormat": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateFormat confidence level"
                    },
                    "certificateExtension": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "certificateExtension confidence level"
                    },
                    "tlsCipherSuites": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "tlsCipherSuites confidence level"
                    },
                    "ikev2TransformTypes": {
                        "$ref": "#/definitions/confidenceLevel",
                        "title": "ikev2TransformTypes confidence level"
                    }
                }
            },
            "detectionContext": {
                "type": "array",
                "additionalItems": false,
                "title": "detection context",
                "description": "Defines additional context metadata related to the detected crypto asset",
                "items": {
                    "type": "object",
                    "title": "detection context",
                    "additionalProperties": false,
                    "properties": {
                        "filePath": {
                            "type": "string",
                            "title": "filePath",
                            "description": "File path of the detected crypto asset"
                        },
                        "lineNumbers": {
                            "type": "array",
                            "title": "lineNumbers",
                            "description": "Line numbers of the detected crypto asset"
                        },
                        "offsets": {
                            "type": "array",
                            "title": "offsets",
                            "description": "Offsets of the detected crypto asset"
                        },
                        "symbols": {
                            "type": "array",
                            "title": "symbols",
                            "description": "symbol names detected for the crypto asset"
                        },
                        "keywords": {
                            "type": "array",
                            "title": "keywords",
                            "description": "keywords detected for the crypto asset"
                        },
                        "additionalContext": {
                            "type": "string",
                            "title": "additionalContext",
                            "description": "additional context of the detected crypto asset (e.g. code snippet)"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "cryptoRef": {
            "type": "string",
            "title": "Reference to a crypto asset",
            "description": "Reference (bom-ref) to the crypto asset used in this context"
        },
        "confidenceLevel": {
            "title": "ConfidenceLevel",
            "description": "The ConfidenceLevel related to a property",
            "type": "number"
        },
        "cipherSuite": {
            "type": "object",
            "title": "Cipher suite",
            "description": "Object representing a cipher suite",
            "additionalItems": false,
            "properties": {
                "name": {
                    "type": "string",
                    "title": "Common name",
                    "description": "A common name for the cipher suite",
                    "examples": [
                        "TLS_DHE_RSA_WITH_AES_128_CCM"
                    ]
                },
                "algorithms": {
                    "type": "array",
                    "title": "Related algorithms",
                    "description": "List of algorithms related to the cipher suite",
                    "additionalItems": false,
                    "items": {
                        "$ref": "#/definitions/cryptoRef",
                        "title": "Algorithm reference",
                        "description": "Bom-ref to algorithm crypto asset"
                    }
                },
                "identifiers": {
                    "type": "array",
                    "title": "Cipher suite identifiers",
                    "description": "A list of common identifiers for the cipher suite",
                    "additionalItems": false,
                    "items": {
                        "type": "string",
                        "title": "identifier",
                        "description": "Cipher suite identifier",
                        "examples": [
                            "0xC0",
                            "0x9E"
                        ]
                    }
                }
            }
        },
        "cryptoRefArray" : {
            "type": "array",
            "additionalItems": false,
            "items": {
                "$ref": "#/definitions/cryptoRef"
            }
        }
    }
}